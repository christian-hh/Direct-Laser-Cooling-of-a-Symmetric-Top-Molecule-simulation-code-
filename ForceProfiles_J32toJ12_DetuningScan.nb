(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105182,       2343]
NotebookOptionsPosition[    102929,       2296]
NotebookOutlinePosition[    103304,       2312]
CellTagsIndexPosition[    103261,       2309]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"ClebschGordan", "::", "tri"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"ClebschGordan", "::", "phy"}], "]"}]}], "Input",
 CellChangeTimes->{{3.770118149078825*^9, 3.770118155653201*^9}, {
   3.7701183368705664`*^9, 3.770118340836793*^9}, 3.770496982548729*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"001fc810-2899-4f59-aa75-3bbb6da51534"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "work", " ", "in", " ", "natural", " ", "units", " ", "where", 
     " ", "k"}], ",", " ", "\[HBar]", ",", " ", 
    SubscriptBox["\[Mu]", "B"], ",", " ", 
    RowBox[{
    "and", " ", "\[CapitalGamma]", " ", "are", " ", "1.", " ", "SI", " ", 
     "base", " ", "units", " ", "are", " ", "defined", " ", 
     RowBox[{"per", ":"}]}]}], "*)"}], 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "\[Equal]", 
        FractionBox["1", "m"]}], ",", 
       RowBox[{"\[CapitalGamma]", "\[Equal]", 
        FractionBox["1", "s"]}], ",", 
       RowBox[{"\[HBar]", "\[Equal]", 
        RowBox[{
         FractionBox["132521403", 
          RowBox[{
          "400000000000000000000000000000000000000000", " ", "\[Pi]"}]], "kg",
          " ", 
         RowBox[{
          SuperscriptBox["m", "2"], "/", "s"}]}]}], ",", 
       RowBox[{"\[Mu]B", "\[Equal]", 
        RowBox[{"\[Mu]BinmsqA", " ", 
         SuperscriptBox["m", "2"], "A"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "s", ",", "A", ",", "kg"}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"dabc2d83-824a-44bc-966b-2f5a898d5555"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ratnz",
   "\"Solve was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,57,1,24987643948996227703,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8031406293855257`*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"0cfa06ec-0c6e-4eb3-9f7b-5c7550c8b1da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"m", "\[Rule]", 
    FractionBox["1", "k"]}], ",", 
   RowBox[{"s", "\[Rule]", "0.21991148575128547`"}], ",", 
   RowBox[{"A", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["k", "2"], " ", "\[Mu]B"}], "\[Mu]BinmsqA"]}], ",", 
   RowBox[{"kg", "\[Rule]", 
    RowBox[{"2.0853154054707824`*^33", " ", 
     SuperscriptBox["k", "2"], " ", "\[HBar]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.776447132400014*^9, 3.7764471563233824`*^9}, 
   3.7764471886502314`*^9, 3.776447260450338*^9, 3.776447670911815*^9, {
   3.7764493624335647`*^9, 3.7764493740992317`*^9}, 3.776514352210908*^9, 
   3.7766842999563627`*^9, 3.77668446022453*^9, 3.776770853956969*^9, 
   3.7767709013266783`*^9, 3.7767710312901115`*^9, 3.776771335512512*^9, 
   3.776772043049981*^9, 3.776783090055834*^9, 3.7771991387910795`*^9, 
   3.777376033247864*^9, 3.7773765760189085`*^9, 3.7773766403355875`*^9, 
   3.7776310805552654`*^9, 3.7780829915547695`*^9, 3.7780830321340904`*^9, 
   3.77825353884005*^9, 3.7943507121559553`*^9, 3.794421735525144*^9, 
   3.794422017063792*^9, {3.794422159599103*^9, 3.7944221700016804`*^9}, 
   3.7944388068091464`*^9, 3.794484167736964*^9, 3.794493589895338*^9, 
   3.794493634506778*^9, 3.7945128312101464`*^9, 3.7945930931953363`*^9, 
   3.794593125843043*^9, 3.7946135837186813`*^9, 3.7946148398922424`*^9, 
   3.794616179102091*^9, 3.79461844159186*^9, {3.794675042965169*^9, 
   3.7946750546418366`*^9}, 3.7947430847802267`*^9, 3.794743333853959*^9, 
   3.79476610507912*^9, 3.7948321771314216`*^9, 3.794838519922949*^9, 
   3.795021448712452*^9, 3.795023933488643*^9, 3.8012602409076405`*^9, {
   3.801260775818613*^9, 3.8012608021613503`*^9}, 3.8012610510402517`*^9, 
   3.8012613484868836`*^9, 3.801268818905613*^9, 3.801279063491284*^9, 
   3.801347948153969*^9, 3.8014816438381824`*^9, 3.801481696115418*^9, 
   3.801481812484581*^9, 3.802165235730942*^9, 3.802197946315115*^9, {
   3.802199178867878*^9, 3.8021991971732235`*^9}, {3.8022009607473383`*^9, 
   3.802200972316984*^9}, 3.802202773924471*^9, 3.802208228352439*^9, {
   3.8022098191380463`*^9, 3.8022098307668085`*^9}, 3.8022114241378174`*^9, 
   3.8022115181140165`*^9, 3.8022124637717276`*^9, 3.802214374118145*^9, 
   3.802214545475809*^9, 3.802216200115312*^9, 3.8022178693362474`*^9, 
   3.8022179856771183`*^9, 3.8022205408262243`*^9, 3.8022294250264688`*^9, 
   3.802229539168619*^9, 3.802229904500452*^9, 3.802231224279044*^9, 
   3.802233164884615*^9, 3.802265483586422*^9, 3.8022655567553735`*^9, 
   3.802265680150366*^9, 3.80226721861307*^9, 3.802267439437136*^9, 
   3.802268075624484*^9, 3.802268144273672*^9, 3.8022687049037333`*^9, 
   3.8022690673141193`*^9, 3.8022693800958853`*^9, 3.802269675529043*^9, 
   3.8022705990393877`*^9, 3.802271130833397*^9, 3.802271707216095*^9, 
   3.802271897963234*^9, {3.8022719497568893`*^9, 3.8022719866482196`*^9}, 
   3.8022720684944973`*^9, 3.802272713594162*^9, 3.802273191494532*^9, 
   3.8022732259293747`*^9, 3.8022772858702097`*^9, 3.8022775078844633`*^9, 
   3.8022780074457593`*^9, 3.802278190298307*^9, 3.8022783042145557`*^9, 
   3.802279157335497*^9, 3.8022792996312785`*^9, 3.802279579883129*^9, 
   3.802279775029383*^9, 3.802279974763618*^9, 3.8022800529524918`*^9, 
   3.802280219453908*^9, 3.8022802961002655`*^9, {3.802280380120332*^9, 
   3.8022803926901016`*^9}, 3.802280721384803*^9, 3.802280849035226*^9, {
   3.8022810562170873`*^9, 3.8022810647604218`*^9}, 3.802281473879985*^9, 
   3.802283522559945*^9, 3.8022865037406807`*^9, 3.8022870625172253`*^9, 
   3.80229306390548*^9, 3.80229968517578*^9, 3.802300534208085*^9, 
   3.8023048561581907`*^9, 3.80230569636627*^9, 3.8023071950479307`*^9, 
   3.8023073161095943`*^9, 3.802307672351227*^9, 3.8023090505355096`*^9, 
   3.8023108989502974`*^9, 3.80231416098909*^9, 3.80243848685176*^9, 
   3.8029641617985744`*^9, 3.8029651563245964`*^9, 3.8029973282029896`*^9, 
   3.8030010777475176`*^9, 3.8031406294262643`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"24367071-70ef-4313-b1a6-1e1f9a7ffa48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"\[HBar]", "=", 
    RowBox[{"\[Mu]B", "=", 
     RowBox[{"\[CapitalGamma]", "=", "1"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"2", "\[Pi]", " ", "\[HBar]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toSpherical", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"1", "/", 
        SqrtBox["2"]}], 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "/", 
        SqrtBox["2"]}], "0"},
      {"0", "0", "1"},
      {
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        SqrtBox["2"]}], 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "/", 
        SqrtBox["2"]}], "0"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]b", 
     RowBox[{"-", "1"}]], ":=", 
    FractionBox[
     RowBox[{
      SubscriptBox["e", "1"], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["e", "2"]}]}], 
     SqrtBox["2"]]}], ";", 
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]b", "0"], ":=", 
    SubscriptBox["e", "3"]}], ";", 
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]b", 
     RowBox[{"+", "1"}]], ":=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SubscriptBox["e", "1"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["e", "2"]}]}], 
      SqrtBox["2"]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"define", " ", "spherical", " ", "basis"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Fpval", "=", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "angular", " ", "momentum", " ", "of", " ", "the", " ", "excited", " ", 
       "state"}], ";", " ", 
      RowBox[{"units", " ", "\[HBar]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Fval", "=", "1"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "angular", " ", "momentum", " ", "of", " ", "the", " ", "ground", " ", 
      "state"}], ";", " ", 
     RowBox[{"units", " ", "\[HBar]"}]}], "*)"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B", "[", "r_", "]"}], ":=", 
   RowBox[{"\[Beta]", 
    FractionBox[
     RowBox[{"\[HBar]", " ", "\[CapitalGamma]"}], "\[Mu]B"], 
    RowBox[{"toSpherical", ".", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}], 
       SqrtBox["2"]], ")"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"magnetic", " ", "field"}], ";", " ", 
    RowBox[{"units", " ", "\[HBar]", " ", 
     RowBox[{"\[CapitalGamma]", "/", 
      SubscriptBox["\[Mu]", "B"]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", "\"\<F\>\"", "]"}], "=", "0.85"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"g", " ", "factor", " ", "of", " ", "ground", " ", "state"}], ";",
     " ", 
    RowBox[{"nominally", " ", 
     RowBox[{"2", "/", "3"}], " ", "but", " ", "set", " ", "to", " ", "0.8", 
     " ", "to", " ", "account", " ", "for", " ", "partial", " ", "decoupling",
      " ", "of", " ", "molecular", " ", "rotation", " ", "and", " ", 
     "spin"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", "\"\<F'\>\"", "]"}], "=", "0"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"g", " ", "factor", " ", "of", " ", "excited", " ", "state"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "k"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ef", "=", 
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Fpval"}]}]], " ", 
     SqrtBox["s0"], " ", "\[CapitalGamma]", " ", "\[HBar]"}], 
    RowBox[{
     SqrtBox["2"], " ", "rme"}]]}], 
  RowBox[{"(*", 
   RowBox[{"electric", " ", "field", " ", "strength"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["e", "i_"], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{"3", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Theta]", "i_"], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CurlyEpsilon]", "[", "r_", "]"}], ":=", " ", 
     RowBox[{"ef", " ", 
      RowBox[{"toSpherical", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{
             SubscriptBox["e", "1"], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               RowBox[{"r", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]]}], "-", 
            RowBox[{
             SubscriptBox["e", "1"], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
               RowBox[{"r", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]]}]}], 
           RowBox[{"2", "\[ImaginaryI]"}]], ")"}]}], ")"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "polarization", " ", "of", " ", "the", " ", "laser", " ", "field"}], 
    "*)"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "=", 
    RowBox[{"\[Pi]", "/", "8"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CurlyEpsilon]", "[", "r_", "]"}], ":=", 
     RowBox[{"toSpherical", ".", 
      RowBox[{"(", 
       RowBox[{"ef", "*", 
        SqrtBox["2"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"k", " ", 
              RowBox[{"r", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", 
             RowBox[{"\[Phi]", "/", "2"}]}], "]"}], 
           RowBox[{"(", 
            FractionBox[
             RowBox[{
              SubscriptBox["e", "1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["e", "2"]}]}], "2"], ")"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"k", " ", 
              RowBox[{"r", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "+", 
             RowBox[{"\[Phi]", "/", "2"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               SubscriptBox["e", "1"], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox["e", "2"]}]}], "2"]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "r_", "]"}], ":=", 
     RowBox[{"ef", "*", 
      SqrtBox["2"], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "1"], 
         RowBox[{"Sin", "[", 
          RowBox[{"k", " ", 
           RowBox[{"r", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "-", 
        RowBox[{
         SubscriptBox["e", "2"], 
         RowBox[{"Cos", "[", 
          RowBox[{"k", " ", 
           RowBox[{"r", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "[", "r_", "]"}], ":=", 
  RowBox[{"ef", "*", 
   SqrtBox["2"], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"k", " ", 
        RowBox[{"r", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], 
      SubscriptBox["\[CurlyEpsilon]b", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"k", " ", 
        RowBox[{"r", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], 
      SubscriptBox["\[CurlyEpsilon]b", 
       RowBox[{"+", "1"}]]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CurlyEpsilon]", "[", "r_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "r", "]"}], ".", 
      SubscriptBox["\[CurlyEpsilon]b", 
       RowBox[{"-", "1"}]]}], ",", 
     RowBox[{
      RowBox[{"e", "[", "r", "]"}], ".", 
      SubscriptBox["\[CurlyEpsilon]b", "0"]}], ",", 
     RowBox[{
      RowBox[{"e", "[", "r", "]"}], ".", 
      SubscriptBox["\[CurlyEpsilon]b", 
       RowBox[{"+", "1"}]]}]}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CurlyEpsilon]", "[", "r_", "]"}], ":=", 
     RowBox[{"toSpherical", ".", 
      RowBox[{"(", 
       RowBox[{"ef", "*", 
        SqrtBox["2"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["e", "1"], 
           RowBox[{"Sin", "[", 
            RowBox[{"k", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "-", 
          RowBox[{
           SubscriptBox["e", "2"], 
           RowBox[{"Cos", "[", 
            RowBox[{"k", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ")"}]}], ")"}]}]}],
     ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rme", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Reduced", " ", "dipole", " ", "matrix", " ", "element"}], ";", 
    " ", 
    RowBox[{"set", " ", "to", " ", "1", " ", "as", " ", 
     RowBox[{"it", "'"}], "s", " ", "the", " ", "same", " ", "for", " ", 
     "all", " ", "involved", " ", "transitions"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7701180426627383`*^9, 3.7701180576685967`*^9}, 
   3.770118129385699*^9, 3.7701212542847557`*^9, {3.7701255677797165`*^9, 
   3.770125571153909*^9}, 3.770126875811531*^9, {3.770126968705845*^9, 
   3.7701270021357565`*^9}, {3.7701271139071493`*^9, 
   3.7701271369634686`*^9}, {3.7701271827390866`*^9, 3.770127188642424*^9}, {
   3.7701272352350893`*^9, 3.7701273313305855`*^9}, {3.77012739189205*^9, 
   3.77012747966807*^9}, {3.77012752337957*^9, 3.770127539618499*^9}, {
   3.7701275836670184`*^9, 3.7701275862421656`*^9}, {3.7701287449314384`*^9, 
   3.7701287472665725`*^9}, 3.7701291631563597`*^9, 3.7701294540359974`*^9, {
   3.770132525364667*^9, 3.7701325271707706`*^9}, {3.770132741205013*^9, 
   3.7701327544027677`*^9}, {3.7701327870286336`*^9, 
   3.7701328530284085`*^9}, {3.770133261972799*^9, 3.770133263474885*^9}, 
   3.770133301796077*^9, {3.7701333894600906`*^9, 3.7701334302124214`*^9}, {
   3.7701334645643864`*^9, 3.770133506130764*^9}, {3.770133541171768*^9, 
   3.770133546755088*^9}, {3.770134093634367*^9, 3.770134099826721*^9}, {
   3.7701341367248316`*^9, 3.7701341410910816`*^9}, {3.7701391407827826`*^9, 
   3.770139141021796*^9}, {3.7701391840782585`*^9, 3.7701391961729507`*^9}, {
   3.770139403294797*^9, 3.7701394062569666`*^9}, {3.770139503150509*^9, 
   3.7701395157732306`*^9}, {3.770139547422041*^9, 3.7701395476770554`*^9}, {
   3.77013958988647*^9, 3.7701396431985188`*^9}, {3.770139674238294*^9, 
   3.7701396860929728`*^9}, {3.77013972783836*^9, 3.7701397280613728`*^9}, 
   3.7701402553515453`*^9, {3.770140986087341*^9, 3.770141016582085*^9}, {
   3.7701410514320784`*^9, 3.7701410635437713`*^9}, {3.7701411100394306`*^9, 
   3.7701411456714687`*^9}, 3.7701421395027957`*^9, 3.770142237821745*^9, {
   3.7701423287022734`*^9, 3.770142328844491*^9}, {3.770142729566832*^9, 
   3.770142730485545*^9}, 3.7701427628110757`*^9, {3.770142800136372*^9, 
   3.7701428481013465`*^9}, {3.7701429290410104`*^9, 3.770142951284346*^9}, {
   3.770143003810012*^9, 3.770143006167142*^9}, {3.7701430989239683`*^9, 
   3.77014310035511*^9}, {3.770144506522935*^9, 3.7701445088943744`*^9}, 
   3.7702221534070168`*^9, 3.770222629767962*^9, {3.7703740678882504`*^9, 
   3.7703741474217987`*^9}, {3.7703741984627185`*^9, 
   3.7703742112784514`*^9}, {3.7703744420306497`*^9, 
   3.7703745097735243`*^9}, {3.770374545869589*^9, 3.770374559069344*^9}, {
   3.7703746054849987`*^9, 3.770374669735674*^9}, {3.770374745533009*^9, 
   3.7703747660131807`*^9}, {3.770374802093244*^9, 3.770374903581049*^9}, {
   3.770375010830183*^9, 3.7703750145573964`*^9}, {3.7703750599339914`*^9, 
   3.7703750779970245`*^9}, {3.770375118781358*^9, 3.7703751992609606`*^9}, {
   3.7703752534540606`*^9, 3.7703753542218237`*^9}, {3.770375391709968*^9, 
   3.7703755446637163`*^9}, {3.7703758383825164`*^9, 
   3.7703758477740536`*^9}, {3.770376809695072*^9, 3.7703769136940207`*^9}, {
   3.7703770344789295`*^9, 3.7703770491177664`*^9}, {3.770377252319389*^9, 
   3.770377255149551*^9}, {3.7703775938549232`*^9, 3.7703776114219284`*^9}, {
   3.770384853056126*^9, 3.7703849555819902`*^9}, {3.770385087120514*^9, 
   3.7703850967990675`*^9}, {3.770385127002795*^9, 3.77038512814186*^9}, {
   3.7703853847525377`*^9, 3.7703853868626585`*^9}, {3.7703860028318896`*^9, 
   3.7703860047339983`*^9}, {3.7703861048797264`*^9, 
   3.7703861087499475`*^9}, {3.770386447715336*^9, 3.770386489567729*^9}, {
   3.770387622720542*^9, 3.770387627167796*^9}, 3.7703876734984465`*^9, {
   3.7703877057592916`*^9, 3.7703878693906507`*^9}, {3.770388268803496*^9, 
   3.7703882703505845`*^9}, {3.7703883377764406`*^9, 3.7703883851031475`*^9}, 
   3.7710927219739885`*^9, {3.7710932432898064`*^9, 3.7710932603247805`*^9}, {
   3.771093658789572*^9, 3.7710936828849497`*^9}, {3.771094984520523*^9, 
   3.7710949867266493`*^9}, 3.7710951984407587`*^9, {3.771095233333754*^9, 
   3.7710952362379203`*^9}, {3.771095498679931*^9, 3.771095499126957*^9}, {
   3.771095647240428*^9, 3.7710956803753233`*^9}, {3.771146065232444*^9, 
   3.771146077519147*^9}, 3.7711461162893643`*^9, {3.7711525364881363`*^9, 
   3.7711525748713317`*^9}, {3.7713299983053713`*^9, 
   3.7713300072168818`*^9}, {3.7713307309992795`*^9, 3.771330744112029*^9}, 
   3.7713310146745048`*^9, 3.7713311633300076`*^9, {3.7713320306906176`*^9, 
   3.7713320307526207`*^9}, 3.7713403879706264`*^9, 3.771669011468956*^9, {
   3.771673325213688*^9, 3.7716733786837463`*^9}, 3.7716734249093904`*^9, 
   3.7717681334285975`*^9, {3.7717790738883553`*^9, 3.7717790816327987`*^9}, {
   3.7717794290086675`*^9, 3.771779847921628*^9}, {3.7717799096501584`*^9, 
   3.7717799162405357`*^9}, {3.771780140515363*^9, 3.771780148097797*^9}, {
   3.7764432870120707`*^9, 3.776443300449839*^9}, {3.776443518809328*^9, 
   3.776443522719552*^9}, {3.7764469432341948`*^9, 3.7764469659624944`*^9}, {
   3.776447052767459*^9, 3.7764471291838303`*^9}, 3.776449248418043*^9, 
   3.776770812671607*^9, {3.776770994384001*^9, 3.7767710241787047`*^9}, {
   3.7944215087872963`*^9, 3.794421510476818*^9}, 3.7944217190571404`*^9, {
   3.801347284589698*^9, 3.801347341833778*^9}, 3.801347430437454*^9, {
   3.8018281848268213`*^9, 3.801828198195368*^9}, {3.801923973801439*^9, 
   3.801923975323788*^9}, 3.8019272172795115`*^9, {3.8022009295201397`*^9, 
   3.8022009298542147`*^9}, {3.8022027467963343`*^9, 3.8022027706624837`*^9}, 
   3.8022036009659004`*^9, {3.802208223613336*^9, 3.8022082247610216`*^9}, {
   3.8022098126809387`*^9, 3.802209812742879*^9}, {3.8022112624368906`*^9, 
   3.8022112694565935`*^9}, {3.8022114489861083`*^9, 
   3.8022114576077914`*^9}, {3.802211493929578*^9, 3.8022115041336927`*^9}, 
   3.8022124390439873`*^9, {3.8022143610514936`*^9, 3.802214361189337*^9}, {
   3.8022161842620993`*^9, 3.8022161843321266`*^9}, {3.8022178600500526`*^9, 
   3.8022178659457636`*^9}, {3.8022203724825735`*^9, 
   3.8022203781687646`*^9}, {3.802220442398139*^9, 3.8022204465060887`*^9}, {
   3.8022204964071164`*^9, 3.802220536874797*^9}, {3.802234208635751*^9, 
   3.8022342126997766`*^9}, {3.802265345313989*^9, 3.802265395383771*^9}, {
   3.8022672598336897`*^9, 3.8022673046227765`*^9}, {3.8022674641373215`*^9, 
   3.8022674655166287`*^9}, {3.802267788565359*^9, 3.8022680947492743`*^9}, {
   3.802272700569067*^9, 3.802272707143772*^9}, {3.8022796493101587`*^9, 
   3.8022796590824976`*^9}, {3.8022796945081215`*^9, 3.802279771466605*^9}, 
   3.802293022683442*^9, 3.8023005217814665`*^9, 3.8023056791797657`*^9, {
   3.8024384735927124`*^9, 3.8024384788316073`*^9}, {3.802439891951541*^9, 
   3.8024398988474245`*^9}, {3.802447505959984*^9, 3.8024475103064194`*^9}, {
   3.802964047850771*^9, 3.802964058931758*^9}, {3.802964168163478*^9, 
   3.802964227325377*^9}, 3.80300105197856*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"21bd2bcb-8396-4af7-b847-2698c811bcd2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "Fpval"}]}]], " ", 
   SqrtBox["s0"]}], 
  RowBox[{
   SqrtBox["2"], " ", "rme"}]]], "Output",
 CellChangeTimes->{
  3.8013479482119803`*^9, 3.8014816438911943`*^9, 3.8014816963154645`*^9, 
   3.8014818126116095`*^9, 3.8021652357479496`*^9, 3.802197946378433*^9, 
   3.8021991972567587`*^9, {3.8022009608248453`*^9, 3.8022009723951716`*^9}, 
   3.802202774002488*^9, 3.802208228453575*^9, {3.80220981921461*^9, 
   3.802209830849859*^9}, 3.8022114242325106`*^9, {3.802211505056751*^9, 
   3.8022115182016125`*^9}, 3.802212463889008*^9, 3.802214374209409*^9, 
   3.8022145455136375`*^9, 3.8022162002121735`*^9, 3.8022178694183297`*^9, 
   3.8022179857579966`*^9, {3.802220537485057*^9, 3.8022205410095043`*^9}, 
   3.8022294251024275`*^9, 3.802229539241576*^9, 3.802229904574562*^9, 
   3.802231224359686*^9, 3.802233164950611*^9, 3.802265483634431*^9, 
   3.802265556811267*^9, 3.802265680207595*^9, 3.802267218683927*^9, 
   3.8022674395171475`*^9, 3.8022679241619573`*^9, 3.8022679583041353`*^9, {
   3.8022680367662096`*^9, 3.802268095118357*^9}, 3.8022681443474717`*^9, 
   3.8022687063147535`*^9, 3.802269067353652*^9, 3.8022693801558647`*^9, 
   3.802269675586647*^9, 3.8022705990913987`*^9, 3.8022711308874083`*^9, 
   3.8022717072761087`*^9, 3.8022718980032434`*^9, {3.8022719497978973`*^9, 
   3.802271986706233*^9}, 3.8022720685361567`*^9, 3.802272713664672*^9, 
   3.802273191559636*^9, 3.8022732259952354`*^9, 3.802277286044677*^9, 
   3.80227750793432*^9, 3.80227800751589*^9, 3.8022781903702335`*^9, 
   3.8022783042747765`*^9, 3.8022791574056425`*^9, 3.8022792996922846`*^9, 
   3.802279579934084*^9, 3.802279775094077*^9, 3.8022799748202443`*^9, 
   3.8022800529961147`*^9, 3.80228021951342*^9, 3.8022802961635113`*^9, {
   3.8022803801800256`*^9, 3.8022803927558117`*^9}, 3.8022807214339056`*^9, 
   3.8022808490914755`*^9, {3.802281056268688*^9, 3.8022810648171387`*^9}, 
   3.802281473934085*^9, 3.8022835226302357`*^9, 3.802286503808546*^9, 
   3.802287062578513*^9, 3.8022930639690657`*^9, 3.802299685226719*^9, 
   3.8023005342717896`*^9, 3.802304856237368*^9, 3.802305696459997*^9, 
   3.802307195128254*^9, 3.8023073162019634`*^9, 3.8023076724036546`*^9, 
   3.8023090506092854`*^9, 3.802310899009707*^9, 3.8023141610263777`*^9, 
   3.8024384869056582`*^9, 3.8029641618676815`*^9, 3.8029651563790183`*^9, 
   3.802997328338169*^9, 3.8030010778278017`*^9, 3.8031406295083017`*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"daac3d85-cc3d-471b-b203-3019f0abfeae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations", "Subsubsection",
 CellChangeTimes->{{3.7701329614446096`*^9, 3.770132967986984*^9}, 
   3.7701332656670103`*^9, 3.7701333062583323`*^9, {3.794350716502695*^9, 
   3.7943507171048307`*^9}, {3.802268706803322*^9, 
   3.8022687092241507`*^9}},ExpressionUUID->"a19f06cb-1c6a-4e9f-b28d-\
8edb977a815f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateOBEs", "[", 
   RowBox[{"{", 
    RowBox[{"fval_", ",", "fpval_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vars", ",", "OBEs", ",", "feqn", ",", "ICs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fval", "=", "fval"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fpval", "=", "fpval"}], ";", "\[IndentingNewLine]", 
     RowBox[{"qs", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "polarizations", " ", "in", " ", "the", " ", "spherical", " ", 
       "basis"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fsubs", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<F\>\"", "\[Rule]", "Fval"}], ",", 
        RowBox[{"\"\<F'\>\"", "\[Rule]", "Fpval"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{
       FractionBox["1", "k"], 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"position", ";", " ", "x"}], ",", "y", ",", 
       RowBox[{"z", " ", "are", " ", "in", " ", "units", " ", "of", " ", 
        RowBox[{"1", "/", "k"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ms", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "Fval"}], ",", "Fval"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "z", " ", "projections", " ", "of", " ", "angular", " ", "momentum", 
       " ", "in", " ", "the", " ", "ground", " ", "state"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ns", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "Fpval"}], ",", "Fpval"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "z", " ", "projections", " ", "of", " ", "angular", " ", "momentum", 
       " ", "in", " ", "the", " ", "excited", " ", "state"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Relevant", " ", "functions"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "q_"], "[", "r_", "]"}], ":=", 
      RowBox[{
       RowBox[{"B", "[", "r", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"q", "+", "2"}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "magnetic", " ", "field", " ", "in", " ", "the", " ", "spherical", " ", 
       "basis"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CurlyEpsilon]", "q_"], "[", "r_", "]"}], ":=", 
      RowBox[{
       RowBox[{"\[CurlyEpsilon]", "[", "r", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"q", "+", "2"}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "electric", " ", "field", " ", "in", " ", "the", " ", "spherical", " ", 
       "basis"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"\[Sigma]",RowBox[{"{", 
          RowBox[{"m_", ",", "n_"}], "}"}],RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}]},
       "Subsuperscript"], ":=", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "m", ",", "n", ",", "t"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "pretty", " ", "print", " ", "for", " ", "expectation", " ", "values", 
       " ", "of", " ", "spin", " ", "operators"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"\[CapitalGamma]",RowBox[{"{", 
          RowBox[{"m_", ",", "n_"}], "}"}],"q_"},
       "Subsuperscript"], ":=", 
      RowBox[{"\[CapitalGamma]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "Fpval"}], "+", "1"}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"m", "-", "n"}]], 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Fval", ",", 
           RowBox[{"-", "m"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "q"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Fpval", ",", 
           RowBox[{"m", "+", "q"}]}], "}"}]}], "]"}], 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Fval", ",", 
           RowBox[{"-", "n"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "q"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Fpval", ",", 
           RowBox[{"n", "+", "q"}]}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"relaxation", " ", "rate"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"\[CapitalOmega]","n_","q_"},
       "Subsuperscript"], ":=", 
      RowBox[{
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", "\[HBar]"}]], 
       RowBox[{
        SubscriptBox["\[CurlyEpsilon]", 
         RowBox[{"-", "q"}]], "[", "r", "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"Fval", "-", "n"}]], 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Fval", ",", 
           RowBox[{"-", "n"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "q"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Fpval", ",", 
           RowBox[{"n", "+", "q"}]}], "}"}]}], "]"}], "rme"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Rabi", " ", "frequency"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"\[Beta]",RowBox[{"{", 
          RowBox[{"m_", ",", "n_"}], "}"}],RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}]},
       "Subsuperscript"], ":=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["B", "q"], "[", "r", "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Conjugate", "[", 
               TemplateBox[{"\[Mu]",RowBox[{"n", "-", "q"}],RowBox[{"{", 
                   RowBox[{"q", ",", "j"}], "}"}]},
                "Subsuperscript"], "]"}], 
              TemplateBox[{"\[Sigma]",RowBox[{"{", 
                  RowBox[{"m", ",", 
                    RowBox[{"n", "-", "q"}]}], "}"}],RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}]},
               "Subsuperscript"]}], "-", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               TemplateBox[{"\[Mu]","m",RowBox[{"{", 
                   RowBox[{"q", ",", "i"}], "}"}]},
                "Subsuperscript"], "]"}], 
              TemplateBox[{"\[Sigma]",RowBox[{"{", 
                  RowBox[{
                    RowBox[{"m", "+", "q"}], ",", "n"}], "}"}],RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}]},
               "Subsuperscript"]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             SubscriptBox["B", "q"], "[", "r", "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              TemplateBox[{"\[Mu]","n",RowBox[{"{", 
                  RowBox[{"q", ",", "j"}], "}"}]},
               "Subsuperscript"], 
              TemplateBox[{"\[Sigma]",RowBox[{"{", 
                  RowBox[{"m", ",", 
                    RowBox[{"n", "+", "q"}]}], "}"}],RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}]},
               "Subsuperscript"]}], "-", 
             RowBox[{
              TemplateBox[{"\[Mu]",RowBox[{"m", "-", "q"}],RowBox[{"{", 
                  RowBox[{"q", ",", "i"}], "}"}]},
               "Subsuperscript"], 
              TemplateBox[{"\[Sigma]",RowBox[{"{", 
                  RowBox[{
                    RowBox[{"m", "-", "q"}], ",", "n"}], "}"}],RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}]},
               "Subsuperscript"]}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "qs"}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Zeeman", " ", "interaction", " ", "term"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"\[Mu]","n_",RowBox[{"{", 
          RowBox[{"q_", ",", "j_"}], "}"}]},
       "Subsuperscript"], ":=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "\[HBar]"]}], 
       RowBox[{"g", "[", "j", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Mu]B", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"j", "-", "n"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "q"], 
           SqrtBox[
            RowBox[{"j", 
             RowBox[{"(", 
              RowBox[{"j", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "j"}], "+", "1"}], ")"}]}]], 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"-", "n"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "q"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"n", "+", "q"}]}], "}"}]}], "]"}]}], ")"}], "/.", 
         "fsubs"}], ")"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"magnetic", " ", "dipole", " ", "moment"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Bloch", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"D\[Sigma]",RowBox[{"{", 
          RowBox[{"m_", ",", "n_"}], "}"}],RowBox[{"{", 
          RowBox[{"\"F\"", ",", "\"F\""}], "}"}]},
       "Subsuperscript"], ":=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Conjugate", "[", 
             TemplateBox[{"\[CapitalOmega]","n","q"},
              "Subsuperscript"], "]"}]}], 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{"m", ",", 
                 RowBox[{"n", "+", "q"}]}], "}"}],RowBox[{"{", 
               RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
            "Subsuperscript"]}], "-", 
          RowBox[{
           TemplateBox[{"\[CapitalOmega]","m","q"},
            "Subsuperscript"], " ", 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{
                 RowBox[{"m", "+", "q"}], ",", "n"}], "}"}],RowBox[{"{", 
               RowBox[{"\"F'\"", ",", "\"F\""}], "}"}]},
            "Subsuperscript"]}], "+", 
          RowBox[{
           TemplateBox[{"\[CapitalGamma]",RowBox[{"{", 
               RowBox[{"m", ",", "n"}], "}"}],"q"},
            "Subsuperscript"], 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{
                 RowBox[{"m", "+", "q"}], ",", 
                 RowBox[{"n", "+", "q"}]}], "}"}],RowBox[{"{", 
               RowBox[{"\"F'\"", ",", "\"F'\""}], "}"}]},
            "Subsuperscript"]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "qs"}], "}"}]}], "]"}], "+", 
       TemplateBox[{"\[Beta]",RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}],RowBox[{"{", 
           RowBox[{"\"F\"", ",", "\"F\""}], "}"}]},
        "Subsuperscript"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"D\[Sigma]",RowBox[{"{", 
          RowBox[{"m_", ",", "n_"}], "}"}],RowBox[{"{", 
          RowBox[{"\"F'\"", ",", "\"F'\""}], "}"}]},
       "Subsuperscript"], ":=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            TemplateBox[{"\[CapitalOmega]",RowBox[{"m", "-", "q"}],"q"},
             "Subsuperscript"], "]"}], 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{
                 RowBox[{"m", "-", "q"}], ",", "n"}], "}"}],RowBox[{"{", 
               RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
            "Subsuperscript"]}], "+", 
          RowBox[{
           TemplateBox[{"\[CapitalOmega]",RowBox[{"n", "-", "q"}],"q"},
            "Subsuperscript"], " ", 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{"m", ",", 
                 RowBox[{"n", "-", "q"}]}], "}"}],RowBox[{"{", 
               RowBox[{"\"F'\"", ",", "\"F\""}], "}"}]},
            "Subsuperscript"]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "qs"}], "}"}]}], "]"}], "-", 
       RowBox[{"\[CapitalGamma]", 
        TemplateBox[{"\[Sigma]",RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}],RowBox[{"{", 
            RowBox[{"\"F'\"", ",", "\"F'\""}], "}"}]},
         "Subsuperscript"]}], "+", 
       TemplateBox[{"\[Beta]",RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}],RowBox[{"{", 
           RowBox[{"\"F'\"", ",", "\"F'\""}], "}"}]},
        "Subsuperscript"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      TemplateBox[{"D\[Sigma]",RowBox[{"{", 
          RowBox[{"m_", ",", "n_"}], "}"}],RowBox[{"{", 
          RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
       "Subsuperscript"], ":=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           TemplateBox[{"\[CapitalOmega]",RowBox[{"n", "-", "q"}],"q"},
            "Subsuperscript"], 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{"m", ",", 
                 RowBox[{"n", "-", "q"}]}], "}"}],RowBox[{"{", 
               RowBox[{"\"F\"", ",", "\"F\""}], "}"}]},
            "Subsuperscript"]}], "-", 
          RowBox[{
           TemplateBox[{"\[CapitalOmega]","m","q"},
            "Subsuperscript"], " ", 
           TemplateBox[{"\[Sigma]",RowBox[{"{", 
               RowBox[{
                 RowBox[{"m", "+", "q"}], ",", "n"}], "}"}],RowBox[{"{", 
               RowBox[{"\"F'\"", ",", "\"F'\""}], "}"}]},
            "Subsuperscript"]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "qs"}], "}"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]"}], " ", "-", " ", 
          RowBox[{"\[CapitalGamma]", "/", "2"}]}], ")"}], 
        TemplateBox[{"\[Sigma]",RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}],RowBox[{"{", 
            RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
         "Subsuperscript"]}], "+", 
       TemplateBox[{"\[Beta]",RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}],RowBox[{"{", 
           RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
        "Subsuperscript"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SimplifyOBEs1", "[", "q_", "]"}], ":=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ComplexExpand", "[", "q", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[HBar]", ">", "0"}], ",", 
          RowBox[{
           SubscriptBox["\[Mu]", "B"], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"g", "[", "F_", "]"}], "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"rme", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{
            "a_", ",", "b_", ",", "c_", ",", "d_", ",", "e_", ",", "f_"}], 
            "]"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"\[CapitalDelta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[CapitalGamma]", ">", "0"}], ",", 
          RowBox[{"x", "\[Element]", "Reals"}], ",", 
          RowBox[{"y", "\[Element]", "Reals"}], ",", 
          RowBox[{"z", "\[Element]", "Reals"}], ",", 
          RowBox[{"A", ">", "0"}], ",", 
          RowBox[{"s0", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SimplifyOBEs2", "[", "q_", "]"}], ":=", 
      RowBox[{"ApplySides", "[", 
       RowBox[{"SimplifyOBEs1", ",", "q"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Simplify", " ", "the", " ", "Bloch", " ", "equations"}], ",", 
       " ", 
       RowBox[{
       "making", " ", "plausible", " ", "assumptions", " ", "about", " ", 
        "the", " ", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "\"\<F\>\"", ",", "\"\<F\>\"", ",", "i", ",", "m", ",", 
                 "\"\<r\>\"", ",", "t"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "m"}], ",", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{
                  "\"\<F\>\"", ",", "\"\<F\>\"", ",", "i", ",", "m", ",", 
                   "\"\<i\>\"", ",", "t"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "Fval"}], ",", "m"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "ms"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "\"\<F'\>\"", ",", "\"\<F'\>\"", ",", "i", ",", "n", ",", 
                 "\"\<r\>\"", ",", "t"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "n"}], ",", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{
                  "\"\<F'\>\"", ",", "\"\<F'\>\"", ",", "i", ",", "n", ",", 
                   "\"\<i\>\"", ",", "t"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "Fpval"}], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ns"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "m", ",", "n", ",", 
                 "\"\<r\>\"", ",", "t"}], "]"}], ",", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "m", ",", "n", ",", 
                 "\"\<i\>\"", ",", "t"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "ms"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ns"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"favg", "[", 
            RowBox[{"i", ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "List", " ", "the", " ", "variables", " ", "to", " ", "be", " ", 
       "solved"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OBEs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ParallelMap", "[", 
           RowBox[{"SimplifyOBEs2", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{
                    "\"\<F\>\"", ",", "\"\<F\>\"", ",", "i", ",", "m", ",", 
                    "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
                    TemplateBox[{"D\[Sigma]",RowBox[{"{", 
                    RowBox[{"i", ",", "m"}], "}"}],RowBox[{"{", 
                    RowBox[{"\"F\"", ",", "\"F\""}], "}"}]},
                    "Subsuperscript"]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "Fval"}], ",", "m"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "ms"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{
                    "\"\<F'\>\"", ",", "\"\<F'\>\"", ",", "i", ",", "n", ",", 
                    "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
                    TemplateBox[{"D\[Sigma]",RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}],RowBox[{"{", 
                    RowBox[{"\"F'\"", ",", "\"F'\""}], "}"}]},
                    "Subsuperscript"]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "Fpval"}], ",", "n"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"n", ",", "ns"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{
                    "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "m", ",", "n", ",", 
                    "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
                    TemplateBox[{"D\[Sigma]",RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}],RowBox[{"{", 
                    RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
                    "Subsuperscript"]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "ms"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"n", ",", "ns"}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "/.", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["\[Sigma]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
                    ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "t_"}],
                    "]"}], "\[Equal]", "e_"}], "\[Rule]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["\[Sigma]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
                    ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "\"\<r\>\"", ",", 
                    "t"}], "]"}], "\[Equal]", 
                    RowBox[{"Re", "[", "e", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["\[Sigma]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
                    ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "\"\<i\>\"", ",", 
                    "t"}], "]"}], "\[Equal]", 
                    RowBox[{"Im", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
                  "}"}]}], "}"}]}], "/.", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "t"}], 
                 "]"}], "\[Rule]", " ", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", "\"\<r\>\"", ",", 
                   "t"}], "]"}], "+", 
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{
                   "a", ",", "b", ",", "c", ",", "d", ",", "\"\<i\>\"", ",", 
                    "t"}], "]"}]}]}]}], "}"}]}], "]"}]}], "]"}], "/.", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{
             "\"\<F'\>\"", ",", "\"\<F\>\"", ",", "a_", ",", "b_", ",", "c_", 
              ",", "d_"}], "]"}], "\[Rule]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"c", "\[Equal]", "\"\<r\>\""}], ",", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{
               "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "b", ",", "a", ",", "c", 
                ",", "d"}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "b", ",", "a", ",", "c", 
                 ",", "d"}], "]"}]}]}], "]"}]}], "}"}]}], "/.", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Sigma]", "[", 
              RowBox[{
              "e_", ",", "e_", ",", "a_", ",", "b_", ",", "\"\<r\>\"", ",", 
               "d_"}], "]"}], "/;", 
             RowBox[{"a", ">", "b"}]}], "\[Rule]", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{
             "e", ",", "e", ",", "b", ",", "a", ",", "\"\<r\>\"", ",", "d"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Sigma]", "[", 
              RowBox[{
              "e_", ",", "e_", ",", "a_", ",", "b_", ",", "\"\<i\>\"", ",", 
               "d_"}], "]"}], "/;", 
             RowBox[{"a", ">", "b"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"\[Sigma]", "[", 
              RowBox[{
              "e", ",", "e", ",", "b", ",", "a", ",", "\"\<i\>\"", ",", "d"}],
               "]"}]}]}]}], "}"}]}], "/.", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Sigma]", 
             TagBox[
              RowBox[{"(", 
               RowBox[{
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{
            "a_", ",", "a_", ",", "b_", ",", "b_", ",", "\"\<i\>\"", ",", 
             "t"}], "]"}], "\[Equal]", "c_"}], "\[Rule]", " ", "None"}], 
         "}"}]}], "/.", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{
          "a_", ",", "a_", ",", "b_", ",", "b_", ",", "\"\<i\>\"", ",", "t"}],
           "]"}], "\[Rule]", "0"}], "}"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Generate", " ", "the", " ", "equations", " ", "of", " ", "motion", " ",
        "for", " ", "the", " ", "upper", " ", "diagonal", " ", "portion", " ",
        "of", " ", "a", " ", "density", " ", "matrix"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ICs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{
                 "\"\<F\>\"", ",", "\"\<F\>\"", ",", "i", ",", "m", ",", 
                  "\"\<r\>\"", ",", "0"}], "]"}], "\[Equal]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "\[Equal]", "m"}], ",", 
                  FractionBox["1", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Fval"}], "+", "1"}], ")"}]], ",", 
                  "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "m"}], ",", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{
                   "\"\<F\>\"", ",", "\"\<F\>\"", ",", "i", ",", "m", ",", 
                    "\"\<i\>\"", ",", "0"}], "]"}], "\[Equal]", "0"}]}], 
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "Fval"}], ",", "m"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "ms"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{
                 "\"\<F'\>\"", ",", "\"\<F'\>\"", ",", "i", ",", "n", ",", 
                  "\"\<r\>\"", ",", "0"}], "]"}], "\[Equal]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "n"}], ",", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{
                   "\"\<F'\>\"", ",", "\"\<F'\>\"", ",", "i", ",", "n", ",", 
                    "\"\<i\>\"", ",", "0"}], "]"}], "\[Equal]", "0"}]}], 
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "Fpval"}], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ns"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{
                 "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "m", ",", "n", ",", 
                  "\"\<r\>\"", ",", "0"}], "]"}], "\[Equal]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{
                 "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "m", ",", "n", ",", 
                  "\"\<i\>\"", ",", "0"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"m", ",", "ms"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "ns"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
         "}"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generates", " ", "initial", " ", "conditions"}], ",", " ", 
       RowBox[{
       "currently", " ", "for", " ", "a", " ", "fully", " ", "mixed", " ", 
        "ground", " ", "state"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"feqn", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ComplexExpand", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "\[HBar]", " ", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    TemplateBox[{"\[Sigma]",RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "+", "q"}], ",", "m"}], "}"}],RowBox[{"{", 
                    RowBox[{"\"F'\"", ",", "\"F\""}], "}"}]},
                    "Subsuperscript"], 
                    RowBox[{
                    SubscriptBox["\[Del]", "r"], 
                    TemplateBox[{"\[CapitalOmega]","m","q"},
                    "Subsuperscript"]}]}], "-", 
                   RowBox[{
                    TemplateBox[{"\[Sigma]",RowBox[{"{", 
                    RowBox[{"m", ",", 
                    RowBox[{"m", "+", "q"}]}], "}"}],RowBox[{"{", 
                    RowBox[{"\"F\"", ",", "\"F'\""}], "}"}]},
                    "Subsuperscript"], 
                    RowBox[{"Conjugate", "[", 
                    RowBox[{
                    SubscriptBox["\[Del]", "r"], 
                    TemplateBox[{"\[CapitalOmega]","m","q"},
                    "Subsuperscript"]}], "]"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "qs"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "ms"}], "}"}]}], "]"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Sigma]", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
                    ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "t_"}], 
                  "]"}], "\[Equal]", "e_"}], "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["\[Sigma]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
                    ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "\"\<r\>\"", ",", 
                    "t"}], "]"}], "\[Equal]", 
                   RowBox[{"Re", "[", "e", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["\[Sigma]", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
                    ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "\"\<i\>\"", ",", 
                    "t"}], "]"}], "\[Equal]", 
                   RowBox[{"Im", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
                 "}"}]}], "}"}]}], "/.", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "t"}], 
                "]"}], "\[Rule]", " ", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{
                 "a", ",", "b", ",", "c", ",", "d", ",", "\"\<r\>\"", ",", 
                  "t"}], "]"}], "+", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", "\"\<i\>\"", ",", 
                   "t"}], "]"}]}]}]}], "}"}]}], "/.", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Sigma]", "[", 
               RowBox[{
               "\"\<F'\>\"", ",", "\"\<F\>\"", ",", "a_", ",", "b_", ",", 
                "c_", ",", "d_"}], "]"}], "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"c", "\[Equal]", "\"\<r\>\""}], ",", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{
                 "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "b", ",", "a", ",", "c",
                   ",", "d"}], "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{
                  "\"\<F\>\"", ",", "\"\<F'\>\"", ",", "b", ",", "a", ",", 
                   "c", ",", "d"}], "]"}]}]}], "]"}]}], "}"}]}], "/.", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "e_", ",", "e_", ",", "a_", ",", "b_", ",", "\"\<r\>\"", ",", 
                 "d_"}], "]"}], "/;", 
               RowBox[{"a", ">", "b"}]}], "\[Rule]", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{
               "e", ",", "e", ",", "b", ",", "a", ",", "\"\<r\>\"", ",", 
                "d"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "e_", ",", "e_", ",", "a_", ",", "b_", ",", "\"\<i\>\"", ",", 
                 "d_"}], "]"}], "/;", 
               RowBox[{"a", ">", "b"}]}], "\[Rule]", 
              RowBox[{"-", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "e", ",", "e", ",", "b", ",", "a", ",", "\"\<i\>\"", ",", 
                 "d"}], "]"}]}]}]}], "}"}]}], "/.", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{
             "a_", ",", "a_", ",", "b_", ",", "b_", ",", "\"\<i\>\"", ",", 
              "t"}], "]"}], "\[Rule]", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"z", "\[Element]", "Reals"}], ",", 
          RowBox[{"s0", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Computes", " ", "the", " ", "force", " ", "in", " ", "terms", " ", 
       "of", " ", "the", " ", "density", " ", "matrix", " ", "elements"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"None", "|", "Null"}]}], "]"}], ",", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"OBEs", ",", "ICs", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"favg", "[", 
                    RowBox[{"i", ",", "t"}], "]"}], ",", "t"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"feqn", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"favg", "[", 
                  RowBox[{"i", ",", "0"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"None", "|", "Null"}]}], "]"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.770116047877643*^9, 3.770116115015483*^9}, {
   3.770116184997486*^9, 3.770116204804619*^9}, 3.7701162484391146`*^9, {
   3.7701163079905205`*^9, 3.7701163737812843`*^9}, {3.7701164128725195`*^9, 
   3.7701168006456995`*^9}, {3.7701169807920027`*^9, 
   3.7701170829038434`*^9}, {3.7701171322166643`*^9, 3.770117349240077*^9}, {
   3.7701173894803786`*^9, 3.7701174362960567`*^9}, {3.7701176252238626`*^9, 
   3.7701177878621645`*^9}, {3.770117832504718*^9, 3.770117935991637*^9}, {
   3.7701179759599233`*^9, 3.770117995993069*^9}, {3.77011803989758*^9, 
   3.7701180982019153`*^9}, {3.7701181293956995`*^9, 3.770118129455703*^9}, {
   3.770118168184918*^9, 3.770118361658984*^9}, {3.770118392377741*^9, 
   3.7701184098147383`*^9}, 3.7701185240392714`*^9, {3.770118595881381*^9, 
   3.770118631081394*^9}, {3.7701187195794563`*^9, 3.7701188802796474`*^9}, {
   3.770118941353141*^9, 3.7701189817044487`*^9}, {3.770119292394219*^9, 
   3.770119354169752*^9}, {3.7701194084578576`*^9, 3.7701195100566683`*^9}, {
   3.7701196862667475`*^9, 3.7701197275451083`*^9}, {3.770119788730608*^9, 
   3.770119819497368*^9}, {3.7701201194505243`*^9, 3.7701201985040455`*^9}, {
   3.7701203817535267`*^9, 3.770120501095353*^9}, 3.7701205418486834`*^9, {
   3.7701208497106156`*^9, 3.7701208498366227`*^9}, {3.7701208969903193`*^9, 
   3.7701209249249177`*^9}, {3.770120955532668*^9, 3.7701210762685738`*^9}, {
   3.770121115550821*^9, 3.7701211404452443`*^9}, {3.7701211985595684`*^9, 
   3.7701212245250535`*^9}, 3.7701212900157995`*^9, {3.770121528783456*^9, 
   3.7701215322376537`*^9}, {3.7701215694907846`*^9, 
   3.7701215754571257`*^9}, {3.770125184532796*^9, 3.7701252482914424`*^9}, {
   3.77012554162222*^9, 3.770125541812231*^9}, {3.770125990788911*^9, 
   3.770126196568681*^9}, {3.7701262266984043`*^9, 3.7701263020537148`*^9}, {
   3.7701269235592623`*^9, 3.7701269769383154`*^9}, {3.7701270443101687`*^9, 
   3.7701271073827763`*^9}, {3.770127158645708*^9, 3.7701271915105886`*^9}, {
   3.770127223241403*^9, 3.7701272299767885`*^9}, {3.7701273449893665`*^9, 
   3.7701273503766747`*^9}, {3.770127496390026*^9, 3.770127510772849*^9}, {
   3.770127569258194*^9, 3.770127569592213*^9}, {3.77012787829687*^9, 
   3.770127969140066*^9}, {3.7701281370626707`*^9, 3.7701282314300685`*^9}, {
   3.770128266549077*^9, 3.7701282696032515`*^9}, {3.770128332214833*^9, 
   3.770128440294015*^9}, {3.770128854904729*^9, 3.77012886191113*^9}, {
   3.770129486133833*^9, 3.7701295215248575`*^9}, {3.7701298090003*^9, 
   3.7701299683884163`*^9}, {3.7701300177502403`*^9, 
   3.7701300181972656`*^9}, {3.7701300592866154`*^9, 3.770130083254987*^9}, 
   3.7701301757672777`*^9, {3.7701302821683636`*^9, 3.77013038000696*^9}, {
   3.7701320980722275`*^9, 3.770132099638317*^9}, {3.77013236194132*^9, 
   3.770132377094187*^9}, {3.7701328729825497`*^9, 3.7701328906205587`*^9}, {
   3.7701339666481037`*^9, 3.7701340449835844`*^9}, {3.770139029043391*^9, 
   3.7701390406420546`*^9}, {3.770139274355422*^9, 3.770139294960601*^9}, {
   3.7701393465145493`*^9, 3.7701393649296026`*^9}, {3.7701409504473023`*^9, 
   3.7701409665582237`*^9}, {3.77014205512779*^9, 3.770142055575163*^9}, {
   3.770142309297284*^9, 3.7701423128852344`*^9}, {3.7702192766917715`*^9, 
   3.770219277279771*^9}, {3.7703738895420494`*^9, 3.7703739112292895`*^9}, {
   3.7703739485334234`*^9, 3.770373955572826*^9}, 3.7703740030135393`*^9, {
   3.770374107510516*^9, 3.7703741123577933`*^9}, {3.770375675544203*^9, 
   3.7703757158315067`*^9}, {3.77038006543629*^9, 3.770380178647765*^9}, {
   3.770380215000845*^9, 3.7703803502255793`*^9}, {3.7703806301775913`*^9, 
   3.770380684139678*^9}, {3.7703854676392784`*^9, 3.7703854677972875`*^9}, {
   3.770385597430702*^9, 3.770385597669716*^9}, {3.7703857769649706`*^9, 
   3.770385777636009*^9}, 3.770385812213987*^9, {3.770386013878522*^9, 
   3.770386017204712*^9}, 3.7710925875262985`*^9, {3.771330859060604*^9, 
   3.7713308621637816`*^9}, {3.7717675567596135`*^9, 3.771767557781672*^9}, {
   3.771767773158991*^9, 3.7717677776382475`*^9}, {3.7717678642592015`*^9, 
   3.771767871761631*^9}, {3.7717679223065214`*^9, 3.771767923233575*^9}, {
   3.771768149706528*^9, 3.771768355454296*^9}, {3.771768434905841*^9, 
   3.7717684428422947`*^9}, 3.7717686740755205`*^9, {3.7717689168764076`*^9, 
   3.7717689300901637`*^9}, {3.7717690538692436`*^9, 3.771769055370329*^9}, {
   3.7717692708116517`*^9, 3.771769318316369*^9}, {3.771769886220851*^9, 
   3.77176988900401*^9}, {3.7717700116770267`*^9, 3.77177001925846*^9}, {
   3.7717700808769846`*^9, 3.7717700906205425`*^9}, {3.7717783341420445`*^9, 
   3.7717783571793623`*^9}, {3.771778463707455*^9, 3.7717784783622932`*^9}, {
   3.771778557837839*^9, 3.7717785605549946`*^9}, {3.771778666637062*^9, 
   3.7717786809238796`*^9}, {3.7717801184301*^9, 3.7717801252294893`*^9}, {
   3.7718405213139133`*^9, 3.771840608431896*^9}, {3.7718406575367045`*^9, 
   3.7718406582717466`*^9}, {3.7718406960499077`*^9, 3.771840717473133*^9}, {
   3.77184075326418*^9, 3.771840808976366*^9}, {3.7718409458591957`*^9, 
   3.7718409584329147`*^9}, {3.7718410194944077`*^9, 3.771841077265712*^9}, 
   3.776447255285043*^9, 3.802269055692934*^9, 3.802269665606385*^9, 
   3.802277997988451*^9, 3.802278177958929*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"b6352aae-0013-411c-84e9-89f2ce5d0503"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Subsubsection",
 CellChangeTimes->{{3.7701329614446096`*^9, 
  3.7701329832348557`*^9}},ExpressionUUID->"58ff47fd-0aeb-4361-8ee7-\
84498dda3c27"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"systems", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"F", ",", "Fp"}], "}"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"alleqns", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"generateOBEs", "[", "FFp", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"FFp", ",", "systems"}], "}"}]}], "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.771769697041031*^9, 3.771769715614093*^9}, {
   3.771769898127532*^9, 3.771769969198597*^9}, {3.7717700501742287`*^9, 
   3.771770053726432*^9}, {3.771770436782342*^9, 3.7717704592486267`*^9}, {
   3.771778744797533*^9, 3.771778758223301*^9}, 3.771841378839961*^9, {
   3.77194823496163*^9, 3.771948247440344*^9}, 3.776443358882181*^9, {
   3.778253467246955*^9, 3.778253476302473*^9}, {3.794421746531375*^9, 
   3.7944217492324343`*^9}, {3.802265371735693*^9, 3.802265372723153*^9}, {
   3.8022674211181517`*^9, 3.8022674211641636`*^9}, {3.8022731861042624`*^9, 
   3.8022732183072405`*^9}, {3.8022781819486666`*^9, 
   3.8022781822200546`*^9}, {3.802278296473399*^9, 3.8022782966546793`*^9}, {
   3.8022792962411346`*^9, 3.8022792969335938`*^9}, {3.802279574425138*^9, 
   3.802279575801688*^9}, {3.8022799579933357`*^9, 3.8022799580575647`*^9}, {
   3.802280045497157*^9, 3.8022800455222144`*^9}, {3.802280370861294*^9, 
   3.80228037097213*^9}, 3.8022808381667566`*^9, {3.8022835181711483`*^9, 
   3.802283518206545*^9}, {3.8022870533491077`*^9, 3.802287053444788*^9}, 
   3.802293060781567*^9, {3.8023005172941194`*^9, 3.8023005173934298`*^9}, {
   3.8023056860488386`*^9, 3.8023056868565087`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"f674eb11-4a4c-49b5-9816-ca34ba835111"],

Cell[BoxData["1.7680209`"], "Output",
 CellChangeTimes->{
  3.8022803977919164`*^9, 3.8022807261929884`*^9, 3.802280852840561*^9, {
   3.8022810586530657`*^9, 3.8022810686303997`*^9}, 3.802281477747*^9, 
   3.8022835247771015`*^9, 3.8022865081448*^9, 3.8022870656591587`*^9, 
   3.802293068969672*^9, 3.8022996873968496`*^9, 3.8023005374187994`*^9, 
   3.8023048592854967`*^9, 3.802305700873822*^9, 3.8023071993598237`*^9, 
   3.8023073183654423`*^9, 3.802307674543043*^9, 3.8023090527596445`*^9, 
   3.802310903307555*^9, 3.8023141627907033`*^9, 3.8024384913007345`*^9, 
   3.8029641637406263`*^9, 3.8029651608729453`*^9, 3.802997332696604*^9, 
   3.8030010824042044`*^9, 3.803140631394885*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"a4d4dca3-1f45-4ee4-af68-56b1e0ebeb34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kmax", "=", "5"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Min", " ", "runtime", " ", "of", " ", "simulation", " ", "in", " ", 
    "units", " ", "2", 
    RowBox[{"\[Pi]k", "/", "v"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmax", "=", "1200"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Min", " ", "runtime", " ", "of", " ", "simulation", " ", "in", " ", 
    "units", " ", 
    RowBox[{"1", "/", "\[CapitalGamma]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ndirs", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "initial", " ", "positions", " ", "at", " ", 
    "which", " ", "to", " ", "compute", " ", "force"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dirs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "npts"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dirs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "ndirs"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "velocities", " ", "at", " ", "which", " ", "to", 
    " ", "compute", " ", "force"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vs1", "=", 
   RowBox[{
    FractionBox["\[CapitalGamma]", "k"], 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "0", ",", "0.10", ",", "0.01"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "0.20", ",", "4", ",", "0.1"}], "}"}]}], "]"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vs", "=", 
   RowBox[{"Join", "[", "vs1", 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"-", "vs1"}]}], "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nvs", "=", 
   RowBox[{"Length", "@", "vs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]s", "=", 
   RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToList", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]s", "=", 
    RowBox[{"{", 
     RowBox[{"0.42", ",", "0.44"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Magnetic", " ", "field", " ", "specified", " ", "in", " ", "terms", " ", 
    "of", " ", "\[Beta]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]s", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "20"}], ",", "20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s0s", "=", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "50", ",", "100", ",", "150", ",", "350", ",", "500", ",", 
      "700"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Intensity", " ", "of", " ", "each", " ", "beam", " ", "in", " ", "terms", 
    " ", "of", " ", "saturation", " ", "intensity"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"{", 
     RowBox[{
     "\[Beta]s", ",", "s0s", ",", "\[CapitalDelta]s", ",", "vs", ",", 
      "dirs"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"npts", "=", 
  RowBox[{"Length", "@", "pts"}]}]}], "Input",
 CellChangeTimes->{
  3.7719482185956936`*^9, {3.771948430625821*^9, 3.771948432032902*^9}, {
   3.7719485427852364`*^9, 3.7719485968483286`*^9}, {3.7719489652644005`*^9, 
   3.7719489818083467`*^9}, {3.7719490145122175`*^9, 
   3.7719492042900724`*^9}, {3.7719492466414948`*^9, 3.771949256160039*^9}, {
   3.7719495198881235`*^9, 3.771949521520217*^9}, {3.771949839217388*^9, 
   3.77194984222456*^9}, 3.7719502319218493`*^9, 3.7719502952494717`*^9, {
   3.7719503937131033`*^9, 3.7719503955362077`*^9}, {3.7719506260173903`*^9, 
   3.7719506269124413`*^9}, {3.776443329370493*^9, 3.7764433483605795`*^9}, {
   3.776443425653*^9, 3.776443475002823*^9}, {3.776443559189638*^9, 
   3.776443565116977*^9}, {3.7764436204931445`*^9, 3.7764436207241573`*^9}, {
   3.7764450935744*^9, 3.7764450936444035`*^9}, {3.7764451903549356`*^9, 
   3.7764451905059443`*^9}, {3.776445255731675*^9, 3.77644536247978*^9}, {
   3.77644546142844*^9, 3.7764454631725397`*^9}, {3.7764466481133146`*^9, 
   3.7764466939599366`*^9}, {3.776447149971019*^9, 3.776447150282037*^9}, 
   3.7764475055943594`*^9, {3.7764476343557243`*^9, 3.776447634697744*^9}, {
   3.7764479074703455`*^9, 3.7764479708059683`*^9}, 3.776448723666029*^9, 
   3.776448929269789*^9, {3.7764491775809917`*^9, 3.7764492686392*^9}, {
   3.7765143143697433`*^9, 3.7765143263384285`*^9}, {3.776684216345581*^9, 
   3.776684284562483*^9}, {3.776771054375432*^9, 3.77677114438258*^9}, {
   3.776771177631482*^9, 3.776771221203974*^9}, {3.776771770397386*^9, 
   3.776771782598084*^9}, {3.7767719335987206`*^9, 3.776771944051318*^9}, {
   3.776782387730663*^9, 3.7767823967621794`*^9}, {3.777199064910854*^9, 
   3.7771991256733294`*^9}, {3.7773759757355742`*^9, 3.777376000859011*^9}, {
   3.777376560277008*^9, 3.777376569989564*^9}, 3.7773766381904645`*^9, {
   3.7776309622985015`*^9, 3.7776310520616355`*^9}, {3.7780829711706038`*^9, 
   3.7780829755288525`*^9}, {3.7943506805223475`*^9, 
   3.7943506805733595`*^9}, {3.7944217707690306`*^9, 3.794421803823927*^9}, {
   3.794422138443391*^9, 3.7944221384950047`*^9}, {3.7944372628137836`*^9, 
   3.7944372636304965`*^9}, {3.7944841409344378`*^9, 
   3.7944841436260605`*^9}, {3.7944935333832407`*^9, 
   3.7944935620126915`*^9}, {3.7945128205854235`*^9, 
   3.7945128238605194`*^9}, {3.7945930624299717`*^9, 3.794593085732882*^9}, {
   3.7945948485735755`*^9, 3.794594856763116*^9}, {3.794600670031863*^9, 
   3.7946007055480003`*^9}, {3.794613345031129*^9, 3.7946134396148515`*^9}, {
   3.7946135619208364`*^9, 3.794613570102687*^9}, {3.7946136154819274`*^9, 
   3.794613615813002*^9}, {3.7946148203975134`*^9, 3.794614821003621*^9}, {
   3.7946182782872906`*^9, 3.7946182865801024`*^9}, {3.7946183616261616`*^9, 
   3.794618412720915*^9}, {3.7946749034302387`*^9, 3.794674937655845*^9}, {
   3.7946749688715525`*^9, 3.7946750279703383`*^9}, {3.79474200164729*^9, 
   3.7947420017213073`*^9}, {3.7947420347122755`*^9, 
   3.7947420357985196`*^9}, {3.7947660712935348`*^9, 3.794766090408183*^9}, {
   3.7948266671778736`*^9, 3.794826718283481*^9}, {3.794838507473133*^9, 
   3.794838513772547*^9}, {3.795020704421714*^9, 3.7950207071543274`*^9}, {
   3.7950234497873993`*^9, 3.7950234509776664`*^9}, 3.801261067426957*^9, {
   3.801261452067378*^9, 3.801261453202631*^9}, {3.801262884185257*^9, 
   3.801262884354295*^9}, {3.801277259768217*^9, 3.8012772620837345`*^9}, {
   3.801345179175456*^9, 3.801345180802819*^9}, {3.801345484119108*^9, 
   3.8013454969999905`*^9}, {3.8013462159937477`*^9, 3.801346258111005*^9}, {
   3.8013462900114927`*^9, 3.801346291538107*^9}, {3.8013570447814894`*^9, 
   3.801357119039366*^9}, {3.8013572225805283`*^9, 3.801357321039879*^9}, {
   3.801357477833852*^9, 3.801357479466339*^9}, {3.801357514696888*^9, 
   3.8013575158221393`*^9}, 3.801481622727164*^9, {3.8014817328461714`*^9, 
   3.80148173302221*^9}, {3.801481802712318*^9, 3.801481807935566*^9}, {
   3.802101039260998*^9, 3.8021010431526265`*^9}, {3.8021394769379163`*^9, 
   3.8021395047275143`*^9}, {3.8021979160063553`*^9, 3.8021979310798545`*^9},
    {3.8022144101162033`*^9, 3.8022144244344654`*^9}, {3.802217914158063*^9, 
   3.8022179427452555`*^9}, 3.80222953437955*^9, {3.802229813131686*^9, 
   3.802229844798796*^9}, {3.802229887603568*^9, 3.8022298938281965`*^9}, {
   3.802231207406311*^9, 3.8022312171729164`*^9}, {3.8022326906565037`*^9, 
   3.8022326918241477`*^9}, {3.8022330982231913`*^9, 3.802233103272404*^9}, {
   3.8022331444912076`*^9, 3.8022331501927657`*^9}, {3.8022654121815777`*^9, 
   3.802265468232147*^9}, {3.8022655527392435`*^9, 3.802265552822279*^9}, {
   3.8022656573995714`*^9, 3.8022656777816916`*^9}, {3.8022692454168663`*^9, 
   3.802269288689811*^9}, {3.8022693688466344`*^9, 3.8022693707054043`*^9}, {
   3.8022753920943155`*^9, 3.802275409184458*^9}, {3.802279147665162*^9, 
   3.802279150099921*^9}, {3.8022799671284547`*^9, 3.8022799692296944`*^9}, {
   3.8022802111434174`*^9, 3.8022802118318157`*^9}, {3.8022807037510834`*^9, 
   3.8022807049203067`*^9}, {3.802281048988903*^9, 3.8022810526153727`*^9}, {
   3.802281402913418*^9, 3.8022814461625624`*^9}, {3.8022864850968494`*^9, 
   3.8022864958167405`*^9}, {3.802299668086402*^9, 3.802299671610792*^9}, {
   3.8023048191137247`*^9, 3.8023048449337087`*^9}, {3.8023068068223114`*^9, 
   3.8023068088390613`*^9}, {3.8023068445359764`*^9, 
   3.8023068712406836`*^9}, {3.802306903904246*^9, 3.8023069226270494`*^9}, {
   3.802306971055953*^9, 3.802306989149514*^9}, {3.8023070300861206`*^9, 
   3.8023070489478884`*^9}, 3.802307255931044*^9, 3.802308766635518*^9, 
   3.8023108890788755`*^9, {3.802364485234971*^9, 3.8023644878981647`*^9}, {
   3.802438453684715*^9, 3.8024384581347675`*^9}, {3.802441962663292*^9, 
   3.80244197514618*^9}, {3.8029641235967712`*^9, 3.80296414557452*^9}, {
   3.8029651529007535`*^9, 3.8029651529647684`*^9}, {3.802997310442162*^9, 
   3.8029973140300465`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"785462d7-9a3a-4457-8678-7276438f0d6b"],

Cell[BoxData["28700"], "Output",
 CellChangeTimes->{
  3.7764466942079506`*^9, 3.7764468367681046`*^9, 3.7764469848665757`*^9, 
   3.776447167263008*^9, 3.776447205514196*^9, 3.776447275822217*^9, 
   3.7764475068334303`*^9, 3.776447675101055*^9, {3.7764479466325855`*^9, 
   3.776447976802311*^9}, 3.7764489295548058`*^9, 3.776449270063281*^9, 
   3.776449393843361*^9, 3.776514371930036*^9, {3.776684232133484*^9, 
   3.776684313336128*^9}, 3.7766845013158803`*^9, {3.7767711112946873`*^9, 
   3.776771185727945*^9}, {3.7767712163356953`*^9, 3.77677122148699*^9}, 
   3.7767713493313026`*^9, 3.7767719443603363`*^9, 3.776772057676818*^9, 
   3.7767831018875103`*^9, 3.7771991545029783`*^9, 3.7773760471786604`*^9, {
   3.777376572677717*^9, 3.777376588091599*^9}, 3.7773766455918875`*^9, {
   3.777631024977086*^9, 3.77763105266567*^9}, 3.7776310939790335`*^9, 
   3.77808304542385*^9, 3.778253553503889*^9, 3.778253591479061*^9, 
   3.7943507258956876`*^9, 3.794421867448941*^9, 3.794422024604062*^9, 
   3.794422176713132*^9, {3.7944388081613007`*^9, 3.794438838006748*^9}, 
   3.7944841709922853`*^9, 3.794493594107906*^9, 3.7944936384077125`*^9, 
   3.7945128323064413`*^9, 3.794593095407996*^9, 3.794593129493284*^9, 
   3.794594920957614*^9, {3.79461359338907*^9, 3.794613621936905*^9}, 
   3.794614843675933*^9, 3.7946161801789722`*^9, {3.794618430159441*^9, 
   3.7946184452692776`*^9}, {3.7946750461669407`*^9, 3.7946750619209833`*^9}, 
   3.7947430880594325`*^9, 3.7947433370436783`*^9, 3.7947661091070423`*^9, 
   3.7948321781480026`*^9, 3.794838520921173*^9, 3.7950214498176994`*^9, 
   3.795023934617896*^9, 3.8012608115512123`*^9, 3.8012610543652344`*^9, 
   3.8012613495601635`*^9, {3.801261703832056*^9, 3.8012617252914715`*^9}, 
   3.8012688201629815`*^9, 3.801279064561027*^9, 3.8013479492486506`*^9, 
   3.801481647705278*^9, 3.801481701294575*^9, 3.8014818160033684`*^9, 
   3.802165236902302*^9, 3.802197947769083*^9, 3.802199200582206*^9, {
   3.8022009633253665`*^9, 3.8022009766353836`*^9}, 3.802202776590212*^9, 
   3.8022082311277704`*^9, {3.802209821781999*^9, 3.802209835024946*^9}, 
   3.802211430561762*^9, 3.8022115214509263`*^9, 3.802212468090783*^9, 
   3.802214378095355*^9, 3.8022145496143475`*^9, 3.8022162042891407`*^9, 
   3.802217871999307*^9, 3.802217988964074*^9, 3.8022205442524333`*^9, 
   3.8022294287157755`*^9, 3.8022295430037403`*^9, 3.8022299078147006`*^9, 
   3.8022312273644524`*^9, 3.802233168101616*^9, 3.8022654854609346`*^9, 
   3.8022655581612887`*^9, 3.8022656813628936`*^9, 3.8022672235855074`*^9, 
   3.802267444463827*^9, 3.802268150038457*^9, 3.802269073625056*^9, 
   3.802269386515341*^9, 3.802269681981962*^9, 3.8022706056324425`*^9, 
   3.8022711374749784`*^9, 3.802271903490735*^9, 3.802271993310288*^9, 
   3.8022720748992186`*^9, 3.8022727200432816`*^9, 3.802273191702376*^9, 
   3.802273232587432*^9, 3.8022773077473264`*^9, 3.8022775129882646`*^9, 
   3.802278014038904*^9, 3.802278194769148*^9, 3.8022783098551135`*^9, 
   3.80227916324545*^9, 3.80227930275314*^9, 3.8022795808932705`*^9, 
   3.802279777814324*^9, 3.8022799784711237`*^9, 3.8022800540237103`*^9, 
   3.802280223399307*^9, 3.802280300090105*^9, 3.8022803979814463`*^9, 
   3.8022807263725348`*^9, 3.8022808530163527`*^9, {3.802281058784439*^9, 
   3.8022810687613487`*^9}, 3.802281477962534*^9, 3.802283524854251*^9, 
   3.8022865083773437`*^9, 3.8022870659448605`*^9, 3.802293069221713*^9, 
   3.8022996876138134`*^9, 3.80230053759039*^9, 3.802304859526887*^9, 
   3.802305701072189*^9, 3.802307199733824*^9, 3.80230731848339*^9, 
   3.8023076747759113`*^9, 3.802309052859949*^9, 3.8023109034825234`*^9, 
   3.802314162876641*^9, 3.802438491795487*^9, 3.802964163829211*^9, 
   3.8029651613583155`*^9, 3.802997332968424*^9, 3.8030010826002483`*^9, 
   3.8031406315762424`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"cfd0c2a0-6631-4408-b6b0-284b57a3b2ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndone", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "[", 
   RowBox[{"outs", ",", "ndone"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"alleqns", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqns", "=", 
    RowBox[{"alleqns", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"To", " ", "simplify", " ", "the", " ", "code"}], ",", " ", 
    RowBox[{
    "we", " ", "compute", " ", "average", " ", "force", " ", "at", " ", "the",
      " ", "same", " ", "time", " ", "as", " ", "integrating", " ", "the", 
     " ", 
     RowBox[{"OBEs", ".", " ", "We"}], " ", "add", " ", "the", " ", "average",
      " ", "force", " ", "to", " ", "the", " ", "variables", " ", "to", " ", 
     "solve", " ", "for"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff", "[", 
    RowBox[{"{", 
     RowBox[{
     "\[Beta]i_", ",", "s0i_", ",", "\[CapitalDelta]i_", ",", "vi_", ",", 
      "diri_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tstep", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vi", "\[NotEqual]", "0"}], ",", 
          FractionBox[
           RowBox[{"2", "\[Pi]", " ", "k"}], 
           RowBox[{"Norm", "[", "vi", "]"}]], ",", 
          RowBox[{"2", "\[Pi]", " ", "k"}]}], "]"}]}], ",", 
       RowBox[{"flast", "=", "1"}], ",", 
       RowBox[{"flast2", "=", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{"stoptrig", "=", "None"}], ",", 
       RowBox[{"fsol", "=", 
        RowBox[{"{", "}"}]}], ",", "eqnsf", ",", "tstop", ",", "out"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tstop", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"kmax", " ", "tstep"}], ",", "tmax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqnsf", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"eqns", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"epop", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"epop", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
            RowBox[{"Total", "@", 
             RowBox[{"Cases", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{
                "\"\<F'\>\"", ",", "\"\<F'\>\"", ",", "a_", ",", "a_", ",", 
                 "\"\<r\>\"", ",", "b_"}], "]"}]}], "]"}]}]}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"x", "\[Rule]", 
            RowBox[{"vi", " ", 
             RowBox[{"diri", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "t"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"vi", " ", 
             RowBox[{"diri", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "t"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"z", "\[Rule]", 
            RowBox[{"vi", " ", 
             RowBox[{"diri", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", "t"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"s0", "\[Rule]", "s0i"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\[Beta]", "\[Rule]", "\[Beta]i"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[CapitalDelta]", "\[Rule]", "\[CapitalDelta]i"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"NDSolveValue", "[", 
        RowBox[{"eqnsf", ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Beta]i", ",", "s0i", ",", "\[CapitalDelta]i", ",", "vi", ",", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"favg", "[", 
                 RowBox[{"dir", ",", "tstop"}], "]"}], "-", 
                RowBox[{"favg", "[", 
                 RowBox[{"dir", ",", 
                  RowBox[{"tstop", "-", "tstep"}]}], "]"}]}], "tstep"], ",", 
              RowBox[{"{", 
               RowBox[{"dir", ",", "3"}], "}"}]}], "]"}], ".", "diri"}], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"epop", "[", "tstop", "]"}], "-", 
             RowBox[{"epop", "[", 
              RowBox[{"tstop", "-", "tstep"}], "]"}]}], "tstep"]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tstop"}], "}"}], ",", 
         RowBox[{"DependentVariables", "\[Rule]", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"vars", ",", 
             RowBox[{"epop", "[", "t", "]"}]}], "}"}]}]}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", 
          RowBox[{"10", "^", "6"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outs", "[", 
        RowBox[{"[", "$KernelID", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], ",", "\[Beta]i",
          ",", "s0i", ",", "\[CapitalDelta]i", ",", "vi", ",", 
         RowBox[{"N", "[", 
          FractionBox["tstop", "tstep"], "]"}], ",", 
         RowBox[{"out", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"out", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ndone", "+=", "1"}], ";", "\[IndentingNewLine]", "out"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"sols", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{"ff", ",", 
        RowBox[{"RandomSample", "@", "pts"}], ",", 
        RowBox[{"Method", "\[Rule]", "Automatic"}]}], "]"}]}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"ndone", "/", "npts"}], "]"}], ",", 
        RowBox[{"TableForm", "[", 
         RowBox[{"outs", ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Time\>\"", ",", "\"\<\[Beta]\>\"", ",", 
               "\"\<\!\(\*SubscriptBox[\(s\), \(0\)]\)\>\"", ",", 
               "\"\<\[CapitalDelta]\>\"", ",", "\"\<v\>\"", ",", 
               "\"\<\!\(\*SubscriptBox[\(n\), \(waves\)]\)\>\"", ",", 
               "\"\<F\>\"", ",", "\"\<Excited Population\>\""}], "}"}]}], 
            "}"}]}]}], "]"}]}], "}"}], "]"}]}], "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.771926628240796*^9, 3.7719267714899893`*^9}, {
   3.771926831539424*^9, 3.771926872688778*^9}, {3.7719271015398674`*^9, 
   3.7719271024489193`*^9}, {3.77194176326747*^9, 3.7719417634374795`*^9}, 
   3.771948469140024*^9, {3.771949358833912*^9, 3.771949496258772*^9}, {
   3.7719495567562323`*^9, 3.7719495576822853`*^9}, {3.7719498801157274`*^9, 
   3.7719499348828597`*^9}, {3.7719499812835135`*^9, 3.771950015699482*^9}, {
   3.7719500618621225`*^9, 3.771950064802291*^9}, {3.771950112242004*^9, 
   3.7719501206574855`*^9}, {3.7719501732694945`*^9, 
   3.7719501784037886`*^9}, {3.771950221748267*^9, 3.7719502272365813`*^9}, {
   3.771950359811164*^9, 3.7719503676016097`*^9}, {3.7764436795185204`*^9, 
   3.776443680149556*^9}, {3.7764453649869237`*^9, 3.776445551203575*^9}, {
   3.7764456618979063`*^9, 3.776445694392765*^9}, {3.7764457688250217`*^9, 
   3.776445813315567*^9}, {3.776445949200339*^9, 3.776446005142538*^9}, {
   3.7764460549563875`*^9, 3.7764461416003437`*^9}, 3.7764461819726524`*^9, {
   3.7764464163570585`*^9, 3.7764464195312405`*^9}, {3.776446467571988*^9, 
   3.7764465751441407`*^9}, {3.7764467364793687`*^9, 
   3.7764467419026785`*^9}, {3.7764467772787023`*^9, 3.776446804461257*^9}, {
   3.7764468840568094`*^9, 3.776446895291452*^9}, {3.776447181685833*^9, 
   3.7764471841919765`*^9}, {3.7764473243419924`*^9, 3.776447346725273*^9}, {
   3.776447425245764*^9, 3.7764474681402173`*^9}, {3.776447516371976*^9, 
   3.7764475196021605`*^9}, {3.7764480850945053`*^9, 3.776448088220684*^9}, {
   3.776448745397272*^9, 3.776448755797867*^9}, {3.776448789698806*^9, 
   3.7764487978672733`*^9}, {3.776449287461276*^9, 3.7764493309217625`*^9}, 
   3.776450416679864*^9, 3.776514388573988*^9, {3.776771307609916*^9, 
   3.776771327906077*^9}, {3.776771849980938*^9, 3.776771852089059*^9}, {
   3.7767718857779856`*^9, 3.776771897796673*^9}, {3.7767719636344385`*^9, 
   3.7767719638154488`*^9}, {3.7767720307522774`*^9, 
   3.7767720309442883`*^9}, {3.7767720737427363`*^9, 
   3.7767720823672295`*^9}, {3.777377003128338*^9, 3.777377026908698*^9}, {
   3.7780829428319826`*^9, 3.778082943239006*^9}, {3.778253581687501*^9, 
   3.778253582214531*^9}, 3.8012688137287226`*^9, 3.802270064405696*^9, {
   3.8022704045548277`*^9, 3.8022704051171255`*^9}, {3.802271118592678*^9, 
   3.802271121706012*^9}, {3.802271696621373*^9, 3.802271714599306*^9}, {
   3.8022718790372243`*^9, 3.8022719696122985`*^9}, {3.8022720592442417`*^9, 
   3.802272063944586*^9}, {3.8022774942305107`*^9, 3.8022775039067*^9}, {
   3.8022789309192533`*^9, 3.802278934140482*^9}, {3.802279104831092*^9, 
   3.8022791057802267`*^9}, 3.8030542694179564`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"5fa27caa-b1fc-4493-848c-bd0fa067954b"],

Cell[BoxData["1560.7745422`"], "Output",
 CellChangeTimes->{3.802307756370122*^9, 3.802309483976112*^9, 
  3.80231173112858*^9, 3.80231498281339*^9, 3.802439341818655*^9, 
  3.802965042650648*^9, 3.8029651915405407`*^9, 3.802998851067583*^9, 
  3.8030026473911996`*^9, 3.803142192373394*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"8b18a5d0-378e-4749-beaa-b91317e4051b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Save", " ", "force", " ", "profiles", " ", "to", " ", "a", " ", 
   RowBox[{"csv", " ", "--"}], " ", "the", " ", "export", " ", "folder", " ", 
   "must", " ", "be", " ", "changed", " ", "accordingly"}], "*)"}]], "Input",
 CellChangeTimes->{{3.801347392256845*^9, 3.8013474173820763`*^9}, {
  3.801347474590823*^9, 3.8013474760479984`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"dc7027ce-ed3b-4ef8-ba3d-53645d836762"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<C:\\\\Users\\\\Christian\\\\Desktop\\\\CaOCH3Data\\\\ptsJ32Jp12_\
DetuningScan.csv\>\"", ",", 
   RowBox[{"Sort", "@", "sols"}], ",", "\"\<CSV\>\"", ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<beta\>\"", ",", "\"\<s0\>\"", ",", "\"\<delta\>\"", ",", 
      "\"\<v\>\"", ",", "\"\<f\>\"", ",", "\"\<epop\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.776448430692272*^9, 3.7764484950099506`*^9}, {
   3.7764486004799833`*^9, 3.776448637125079*^9}, {3.776448669776947*^9, 
   3.7764486973325233`*^9}, {3.776448897535974*^9, 3.776448898583034*^9}, {
   3.7764493368981037`*^9, 3.7764493601954365`*^9}, 3.776514320010066*^9, 
   3.776684297732236*^9, {3.776771239175002*^9, 3.776771239270007*^9}, 
   3.776783054361792*^9, 3.7771991768022537`*^9, 3.7776310685115767`*^9, 
   3.77808301534313*^9, {3.778253601896657*^9, 3.7782536150174074`*^9}, {
   3.794351971475295*^9, 3.7943519966983943`*^9}, {3.794422030892276*^9, 
   3.794422033077857*^9}, {3.79442218430634*^9, 3.794422184382044*^9}, {
   3.794437204552752*^9, 3.7944372075188313`*^9}, {3.794493567400041*^9, 
   3.79449356846969*^9}, 3.7945128269730864`*^9, 3.7945930584534216`*^9, {
   3.7945948339157743`*^9, 3.7945948352047973`*^9}, {3.7946136354490347`*^9, 
   3.7946136373786087`*^9}, 3.794675036260102*^9, 3.7947661020889206`*^9, {
   3.7948384939425273`*^9, 3.794838495656912*^9}, {3.795020744033307*^9, 
   3.795020745552616*^9}, {3.801260822828689*^9, 3.8012608246538596`*^9}, {
   3.801347909247777*^9, 3.8013479114444313`*^9}, {3.801357556467263*^9, 
   3.8013575581336675`*^9}, 3.8014816357817235`*^9, {3.8021010234187627`*^9, 
   3.8021010249479074`*^9}, {3.802139354661508*^9, 3.8021393574167833`*^9}, {
   3.8021395137418356`*^9, 3.802139514294819*^9}, {3.8021979344608326`*^9, 
   3.802197934968686*^9}, 3.802212285100156*^9, 3.802213073725588*^9, {
   3.802265476103095*^9, 3.8022654800859094`*^9}, {3.802271980206929*^9, 
   3.8022719829584475`*^9}, {3.8022773212584295`*^9, 
   3.8022773226233664`*^9}, {3.802279948097253*^9, 3.8022799496346235`*^9}, {
   3.802280049096245*^9, 3.8022800491504593`*^9}, {3.802280286153252*^9, 
   3.8022802862233305`*^9}, 3.8022808413091345`*^9, {3.8022835102656236`*^9, 
   3.802283510299285*^9}, {3.802287048608385*^9, 3.8022870486728535`*^9}, {
   3.8022930506736517`*^9, 3.802293050737827*^9}, {3.8022996600830097`*^9, 
   3.8022996625147552`*^9}, {3.802300512695963*^9, 3.8023005128075294`*^9}, {
   3.802305674963679*^9, 3.80230567503787*^9}, {3.80230705894689*^9, 
   3.802307063209528*^9}, {3.8023087514033394`*^9, 3.8023087525002637`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"72030432-f0a8-46f9-b5c3-4c894340b92e"],

Cell[BoxData["\<\"C:\\\\Users\\\\Christian\\\\Desktop\\\\CaOCH3Data\\\\\
ptsJ32Jp12_DetuningScan.csv\"\>"], "Output",
 CellChangeTimes->{3.803142195054352*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"b5a43926-07d4-49d7-9457-21f8d9f86e79"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2560, 1357},
WindowMargins->{{2552, Automatic}, {Automatic, 0}},
Magnification:>1.7 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 410, 7, 83, "Input",ExpressionUUID->"001fc810-2899-4f59-aa75-3bbb6da51534"],
Cell[CellGroupData[{
Cell[993, 31, 1302, 35, 112, "Input",ExpressionUUID->"dabc2d83-824a-44bc-966b-2f5a898d5555"],
Cell[2298, 68, 445, 10, 39, "Message",ExpressionUUID->"0cfa06ec-0c6e-4eb3-9f7b-5c7550c8b1da"],
Cell[2746, 80, 4072, 62, 85, "Output",ExpressionUUID->"24367071-70ef-4313-b1a6-1e1f9a7ffa48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6855, 147, 16338, 390, 1070, "Input",ExpressionUUID->"21bd2bcb-8396-4af7-b847-2698c811bcd2"],
Cell[23196, 539, 2579, 41, 93, "Output",ExpressionUUID->"daac3d85-cc3d-471b-b203-3019f0abfeae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25812, 585, 315, 5, 74, "Subsubsection",ExpressionUUID->"a19f06cb-1c6a-4e9f-b28d-8edb977a815f"],
Cell[26130, 592, 45839, 1065, 2817, "Input",ExpressionUUID->"b6352aae-0013-411c-84e9-89f2ce5d0503"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72006, 1662, 162, 3, 74, "Subsubsection",ExpressionUUID->"58ff47fd-0aeb-4361-8ee7-84498dda3c27"],
Cell[CellGroupData[{
Cell[72193, 1669, 1925, 38, 83, "Input",ExpressionUUID->"f674eb11-4a4c-49b5-9816-ca34ba835111"],
Cell[74121, 1709, 774, 11, 55, "Output",ExpressionUUID->"a4d4dca3-1f45-4ee4-af68-56b1e0ebeb34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74932, 1725, 10066, 212, 605, "Input",ExpressionUUID->"785462d7-9a3a-4457-8678-7276438f0d6b"],
Cell[85001, 1939, 3894, 54, 55, "Output",ExpressionUUID->"cfd0c2a0-6631-4408-b6b0-284b57a3b2ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88932, 1998, 10099, 224, 1061, "Input",ExpressionUUID->"5fa27caa-b1fc-4493-848c-bd0fa067954b"],
Cell[99034, 2224, 370, 5, 55, "Output",ExpressionUUID->"8b18a5d0-378e-4749-beaa-b91317e4051b"]
}, Open  ]],
Cell[99419, 2232, 460, 7, 49, "Input",ExpressionUUID->"dc7027ce-ed3b-4ef8-ba3d-53645d836762"],
Cell[CellGroupData[{
Cell[99904, 2243, 2752, 43, 49, "Input",ExpressionUUID->"72030432-f0a8-46f9-b5c3-4c894340b92e"],
Cell[102659, 2288, 242, 4, 55, "Output",ExpressionUUID->"b5a43926-07d4-49d7-9457-21f8d9f86e79"]
}, Open  ]]
}, Open  ]]
}
]
*)

